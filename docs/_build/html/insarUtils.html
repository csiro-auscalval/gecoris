

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>gecoris.insarUtils &mdash; gecoris 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="gecoris.geoUtils" href="geoUtils.html" />
    <link rel="prev" title="Modules" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> gecoris
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sentinel_download.html">Sentinel-1 data download</a></li>
<li class="toctree-l1"><a class="reference internal" href="SNAP_processing.html">SNAP processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="insar_processing.html">InSAR processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="corner_reflector_module.html">Corner reflector module</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">gecoris.insarUtils</a></li>
<li class="toctree-l2"><a class="reference internal" href="geoUtils.html">gecoris.geoUtils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Definitions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gecoris</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">Modules</a> &raquo;</li>
        
      <li>gecoris.insarUtils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/insarUtils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-gecoris.insarUtils">
<span id="gecoris-insarutils"></span><h1>gecoris.insarUtils<a class="headerlink" href="#module-gecoris.insarUtils" title="Permalink to this headline">¶</a></h1>
<p>insarUtils</p>
<p>Module containing utilities for time series InSAR analysis</p>
<p>Copyright (C) 2021 by R.Czikhardt</p>
<p>Email: <a class="reference external" href="mailto:czikhardt&#46;richard&#37;&#52;&#48;gmail&#46;com">czikhardt<span>&#46;</span>richard<span>&#64;</span>gmail<span>&#46;</span>com</a>
Last edit: 1.7.2021</p>
<p>This file is part of GECORIS - Geodetic Corner Reflector (In)SAR Toolbox.</p>
<blockquote>
<div><p>GECORIS is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>GECORIS is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with GECORIS. If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
</div></blockquote>
<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.APS">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">APS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psc0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atmoWindow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotFlag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apsDir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.APS" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate Atmospheric Phase Screen (APS) in a network
of 1st order Persistent Scatterer candidates (PSc)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psc</strong> (<em>&lt;HDF dataset&gt;</em>) – 1st order PSc.</p></li>
<li><p><strong>network</strong> (<em>&lt;HDF dataset&gt;</em>) – Solved network of 1st order PSc, see insarUtils.solve_network.</p></li>
<li><p><strong>stack</strong> (<em>&lt;HDF dataset&gt;</em>) – InSAR stack metadata.</p></li>
<li><p><strong>psc0</strong> (<em>&lt;HDF dataset&gt;</em>) – All PSc, including 2nd order to interpolate APS.</p></li>
<li><p><strong>atmoWindow</strong> (<em>int</em><em>, </em><em>optional</em>) – Long-wavelength signal filter window length (in days).
This parameter should reflect the temporal length and sampling of
the dataset. Too small values alias other (displacement) signals,
whereas too large values result in inefficient filtering and
consequently biased APS estimation.
The default is 200.</p></li>
<li><p><strong>plotFlag</strong> (<em>boolean</em><em>, </em><em>optional</em>) – True/False to save plots of spatially estimated APS per each epoch.
The default is False.</p></li>
<li><p><strong>apsDir</strong> (<em>str</em><em>, </em><em>optional</em>) – Full path to directory for saving plots. The default is ‘’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.kriging</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.solve_network</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>This function uses 2 step approach to estimate the APS from the
network residuals.
Firstly, long-wavelength temporal signal (such as unmodelled deformation)
is removed by Gaussian filter in time, assuming the APS to be temporally
decorrelated.
Secondly, empirical variogram is fitted spatially to filtered residuals,
assuming strong spatial correlation of the APS.
Finally, universal kriging with fitted Gaussian variogram model is used
to interpolate the APS over the whole network.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.HDF2csv">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">HDF2csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outCSV</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.HDF2csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to export InSAR results from HDF5 data storage to CSV standard</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>&lt;HDF5 file&gt;</em>) – Pointer to HDF5 file containing InSAR results.</p></li>
<li><p><strong>outCSV</strong> (<em>str</em>) – Full path to .</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For full standard output CSV see template file “output.csv”.
For full HDF5 InSAR file specification, see insarUtils.prepare_insar_HDF</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.KS">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">KS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amp1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.KS" title="Permalink to this definition">¶</a></dt>
<dd><p>KS 2-sample test</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.VCE">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">VCE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">VC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.VCE" title="Permalink to this definition">¶</a></dt>
<dd><p>Variance component estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>VC</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Initial guess on N variance components.</p></li>
<li><p><strong>B1</strong> (<em>(</em><em>N</em><em>,</em><em>M</em><em>) </em><em>ndarray</em>) – Design matrix.</p></li>
<li><p><strong>y</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Vector of observations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>VC</strong> – Variance components after 2 iterations.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N,) ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For references on VCE, see:
- Amiri-Simkooei, A. (2007), Least-Squares Variance Component Estimation;
Theory and GPS Applications, PhD thesis, Delft University of Technology.
- Teunissen, P. J. G. &amp; Amiri-Simkooei, A. R. (2008), ‘Least-squares
variance component estimation’, Journal of Geodesy 82(2), 65–82.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.arcSolveFast">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">arcSolveFast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iZt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Qy_i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.arcSolveFast" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast solution of temporal ambiguities per arc
using LAMBDA and bootstrapping</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Vector of observations.</p></li>
<li><p><strong>Z</strong> (<em>ndarray</em>) – LAMBDA matrices.</p></li>
<li><p><strong>L</strong> (<em>ndarray</em>) – LAMBDA matrices.</p></li>
<li><p><strong>iZt</strong> (<em>ndarray</em>) – LAMBDA matrices.</p></li>
<li><p><strong>N_i</strong> (<em>(</em><em>N</em><em>,</em><em>N</em><em>) </em><em>ndarray</em>) – Inverse of matrix of normal equations.</p></li>
<li><p><strong>B1</strong> (<em>(</em><em>N</em><em>,</em><em>M</em><em>) </em><em>ndarray</em>) – Design matrix.</p></li>
<li><p><strong>Qy_i</strong> (<em>(</em><em>N</em><em>,</em><em>N</em><em>) </em><em>ndarray</em>) – Inverse of variance-covariance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>a</strong> (<em>(N,) ndarray</em>) – Estimated ambiguities.</p></li>
<li><p><strong>uw_ph</strong> (<em>(N,) ndarray</em>) – Unwrapped phase time series per N-epochs.</p></li>
<li><p><strong>x</strong> (<em>(M,)</em>) – Estimated parameters.</p></li>
<li><p><strong>res</strong> (<em>(N,)</em>) – Vector of residuals.</p></li>
<li><p><strong>var</strong> (<em>float</em>) – A-posteriori variance factor.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.bootstrap">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ahat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p># ———————————————————————– #
#   bootstrap: Bootstrapping for integer ambiguity resolution             #
#                                                                         #
#              afixed = bootstrap(ahat,L)                                 #
#                                                                         #
#   This function performs the boostrapping technique for integer         #
#   ambiguity resolution.                                                 #
#                                                                         #
#   Input arguments:                                                      #
#       ahat : float ambiguities (1D numpy array)                         #
#       L    : unit lower triangular matrix from LtDL-decomposition of    #
#              the vc-matrix                                              #
#                                                                         #
#   Output arguments:                                                     #
#      afixed: fixed ambiguities (1D numpy array)                         #
#                                                                         #
#   Note:                                                                 #
#       The success rate with boostrapping depends on the parametrization #
#       of the float ambiguities ahat. It should be applied to the        #
#       decorrelated ambiguities. The complete procedure is then:         #
#           Qzhat,Z,L,D,zhat,iZt = decorrel(Qahat,ahat)                   #
#           zfixed = bootstrap(zhat,L)                                    #
#           afixed = iZt.dot(zfixed)                                      #
#                                                                         #
# ———————————————————————– #
#   Function : boostrap                                                   #
#   Date     : 06-SEP-2010                                                #
#   Author   : Bofeng Li                                                  #
#              GNSS Research Center, Department of Spatial Sciences,      #
#              Curtin University of Technology                            #
# ———————————————————————– #</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.createNetwork">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">createNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'redundant'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_con</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotFlag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outDir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.createNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Create connected estimation network of PSc</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psc</strong> (<em>&lt;HDF5&gt; dataset</em>) – Containing PSc data.</p></li>
<li><p><strong>stack</strong> (<em>&lt;HDF5&gt; dataset</em>) – Containing stack metadata.</p></li>
<li><p><strong>n_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Connection type (‘delaunay’ or ‘redundant’).
The default is ‘redundant’.</p></li>
<li><p><strong>n_con</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of nearby connections. The default is 8.</p></li>
<li><p><strong>max_dist</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold on maximum connection length. The default is 5 km.</p></li>
<li><p><strong>plotFlag</strong> (<em>boolean</em><em>, </em><em>optional</em>) – The default is 1.</p></li>
<li><p><strong>outDir</strong> (<em>str</em><em>, </em><em>optional</em>) – Full path to plot output directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>arcs</strong> – M connection pairs of N points forming network.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(M,2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.decomp">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">decomp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">los</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig_los</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">head</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.decomp" title="Permalink to this definition">¶</a></dt>
<dd><p>LOS to vertical/horizontal displacement decomposition</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.functionalModel">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">functionalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.functionalModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Create design matrix for PSI functional model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<em>&lt;HDF5&gt; file</em>) – Stack metadata.</p></li>
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>optional</em>) – Model type ‘linear’/’seasonal’/’exponential’.
The default is ‘linear’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>A</strong> – Design matrix with rows corresponding to N measurements
and collumns corresponding to M unknown parameters.
Order of the unknowns is:</p>
<blockquote>
<div><p>1 - constant (master atmosphere)
2 - residual height
3 - linear displacement
4,5 - seasonal displacement</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N,M) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.getH2PH">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">getH2PH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.getH2PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute approximate height-to-phase conversion factors for stack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stack</strong> (<em>&lt;HDF5&gt; file</em>) – Stack metadata.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>h2ph</strong> – Height-to-phase conversion factors
PERPENDICULAR BASELINE / (SLANT-RANGE * SIN(INCIDENCE))
for M-epochs in stack</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(M,)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.getPreciseH2PH</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.getPreciseH2PH">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">getPreciseH2PH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outDir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stackId</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.getPreciseH2PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute precise height-to-phase conversion factors for PSc</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psc</strong> (<em>&lt;HDF5&gt; file</em>) – Containing PSc data.</p></li>
<li><p><strong>outDir</strong> (<em>str</em>) – Full path to directory containing stakc JSON file.</p></li>
<li><p><strong>stackId</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>h2ph</strong> – Height-to-phase conversion factors
PERPENDICULAR BASELINE / (SLANT-RANGE * SIN(INCIDENCE))
for N-points and M-epochs in stack</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N,M)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.getH2PH</span></code></p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gecoris.insarUtils.kriging">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">kriging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.kriging" title="Permalink to this definition">¶</a></dt>
<dd><p>Kriging interpolator</p>
<p>…</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">x,</span> <span class="pre">y,</span> <span class="pre">z</span></span></dt>
<dd><p>1D arrays containing coordinates with <cite>float</cite> type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.variogram</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>For now using hardcoded Gaussian model.
For references, see
P.K. Kitanidis, Introduction to Geostatistcs: Applications in Hydrogeology,
(Cambridge University Press, 1997) 272 p.
and <a class="reference external" href="https://github.com/GeoStat-Framework/PyKrige">https://github.com/GeoStat-Framework/PyKrige</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="gecoris.insarUtils.kriging.cov_model">
<span class="sig-name descname"><span class="pre">cov_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nugget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.kriging.cov_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate variogram model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Distance nodes to evaluate variogram.</p></li>
<li><p><strong>nugget</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Include nugget in variogram model. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cv</strong> – Evaluated variogram values at requested nodes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N,) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gecoris.insarUtils.kriging.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.kriging.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform kriging interpolation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x0</strong> (<em>(</em><em>M</em><em>,</em><em>) </em><em>ndarray</em>) – </p></li>
<li><p><strong>y0</strong> (<em>(</em><em>M</em><em>,</em><em>) </em><em>ndarray</em>) – Coordinates of M interpolation nodes</p></li>
<li><p><strong>n_max</strong> (<em>int</em>) – Max number of nearby points to consider for interpolation</p></li>
<li><p><strong>max_d</strong> (<em>float</em>) – Distance threshold to locate nearby points</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sol</strong> – Evaluated z values at requested M nodes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(M,) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gecoris.insarUtils.kriging.kriging_matrix">
<span class="sig-name descname"><span class="pre">kriging_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.kriging.kriging_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct Kriging system matrix and solve it
for universal kriging with drift of order 1</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – </p></li>
<li><p><strong>y</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Coordinates of N known nodes</p></li>
<li><p><strong>x0</strong> (<em>(</em><em>M</em><em>,</em><em>) </em><em>ndarray</em>) – </p></li>
<li><p><strong>y0</strong> (<em>(</em><em>M</em><em>,</em><em>) </em><em>ndarray</em>) – Coordinates of M interpolation nodes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>q</strong> – Kriging design matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N,M) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gecoris.insarUtils.kriging.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outFig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.kriging.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot Kriging APS interpolation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sol</strong> (<em>(</em><em>M</em><em>,</em><em>) </em><em>ndarray</em>) – Interpolated Z values</p></li>
<li><p><strong>outFig</strong> (<em>str</em>) – Full path to save the plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.lambdaPrepare">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">lambdaPrepare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Qy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'dH':</span> <span class="pre">20,</span> <span class="pre">'seasonal':</span> <span class="pre">2,</span> <span class="pre">'vel':</span> <span class="pre">5}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.lambdaPrepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare LAMBDA matrices for ambiguity resoluion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Qy</strong> (<em>(</em><em>N</em><em>,</em><em>N</em><em>) </em><em>ndarray</em>) – Variance-covariance matrix of observations (VCM).</p></li>
<li><p><strong>B1</strong> (<em>(</em><em>N</em><em>,</em><em>M</em><em>)</em>) – Design matrix mapping N observations to M unknowns.</p></li>
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>optional</em>) – Model type ‘linear’/’seasonal’/’exponential’.
The default is ‘linear’.</p></li>
<li><p><strong>bounds</strong> (<em>dict</em><em>, </em><em>optional</em>) – <dl>
<dt>bounds = {‘dH’<span class="classifier"># in [m]</span></dt><dd><blockquote>
<div><p>’vel’: # in [mm/year]
‘seasonal’: # in [mm]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>The default is:
bounds = {‘dH’ : 20, ‘vel’: 5, ‘seasonal’: 2}</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Z, L, iZt</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarrays</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.pseudoVCM</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.lambda_decorrel</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.lambda_decorrel">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">lambda_decorrel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Qa</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.lambda_decorrel" title="Permalink to this definition">¶</a></dt>
<dd><p># ———————————————————————– #
#   decorrel: Decorrelate a (co)variance matrix of ambiguities            #
#                                                                         #
#             Qzhat,Z,L,D,zhat,iZt = decorrel(Qahat)                 #
#                                                                         #
#   This function creates a decorrelated Q-matrix, by finding the         #
#   Z-matrix and performing the corresponding transformation.             #
#                                                                         #                                                                  #
#   Input arguments:                                                      #
#       Qahat: Variance-covariance matrix of ambiguities (original)       #
#              (symmetric n-by-n matrix; 2D numpy array)                  #
#                                                                         #
#   Output arguments:                                                     #
#       Qzhat: Variance-covariance matrix of decorrelated ambiguities     #
#       Z    : Z-transformation matrix                                    #
#       L    : L matrix (from LtDL-decomposition of Qzhat)                #
#       D    : D matrix (from LtDL-decomposition of Qzhat)                #                                  #
#       iZt  : inv(Z’)-transformation matrix                              #
#                                                                         #
# ———————————————————————– #
#   Function : decorrel                                                   #
#   Date     : 19-MAY-1999 / modified 12-APR-2012                         #
#   Author   : Peter Joosten / Sandra Verhagen                            #
#              Mathematical Geodesy and Positioning,                      #
#              Delft University of Technology                             #
# ———————————————————————– #</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.lambda_fast">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">lambda_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iZt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.lambda_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>Bootstrap solution for LAMBDA</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.ldldecom">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">ldldecom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Qahat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.ldldecom" title="Permalink to this definition">¶</a></dt>
<dd><p># ———————————————————————– #
#   ldldecom: Find LtDL-decomposition of Qahat-matrix                     #
#                                                                         #
#             L,D = ldldecom(Qahat)                                       #
#                                                                         #
#   This function finds the LtDL decomposition of a given ambiguity       #
#   variance-covariance matrix.                                           #
#                                                                         #
#   Input arguments:                                                      #
#       Qahat: Variance-covariance matrix of ambiguities to be factored   #
#              (symmetric n-by-n matrix; 2D numpy array)                  #
#                                                                         #
#   Output arguments:                                                     #
#       L    : n-by-n factor matrix (2D numpy array)                      #
#              (unit lower triangular)                                    #
#       D    : Diagonal n-vector (1D numpy array)                         #
#                                                                         #
# ———————————————————————– #
#   Function : ldldecom                                                   #
#   Date     : 19-MAY-1999                                                #
#   Author   : Peter Joosten                                              #
#              Mathematical Geodesy and Positioning,                      #
#              Delft University of Technology                             #
# ———————————————————————– #</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.loadCSV_insar">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">loadCSV_insar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inCSV</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.loadCSV_insar" title="Permalink to this definition">¶</a></dt>
<dd><p>Load standard CSV InSAR results to python dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inCSV</strong> (<em>str</em>) – Full path to standard CSV InSAR results.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ts</strong> (<em>(N,M) ndarray</em>) – Time series matrix for N points and M time series.</p></li>
<li><p><strong>insarDates</strong> (<em>(M,) ndarray of int, matplotlib.dates</em>) – Acquisition dates of time series.</p></li>
<li><p><strong>masterIdx</strong> (<em>int</em>) – Index of master date in time series.</p></li>
<li><p><strong>masterDate</strong> (<em>int, matplotlib.dates</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.network_cond">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">network_cond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.network_cond" title="Permalink to this definition">¶</a></dt>
<dd><p>Check network conditioning before spatial unwrapping
(PS network could be singular w.r.t. selected ref. point, e.g.,</p>
<blockquote>
<div><p>could contain isolated points/sub-networks)</p>
</div></blockquote>
<p>Isolated sub-networks causing singularity are automatically removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>&lt;HDF5 file&gt;</em>) – Containing ‘network2’ dataset (created by insarUtils.remove_outliers)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Should be run after insarUtils.setRefPoint()
and before insarUtils.spatialAmbiguity()</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.openHDF">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">openHDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.openHDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for loading &lt;HDF5&gt; data stack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>projfile</strong> (<em>str</em>) – Full path to &lt;HDF5&gt; InSAR data file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pointer to HDF5 file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>&lt;HDF5 file&gt;</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.order_psc">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">order_psc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.order_psc" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate PS candidates to 1st and 2nd order</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>&lt;HDF5 file&gt;</em>) – Insar stack with ‘psc’ structure</p></li>
<li><p><strong>thr</strong> (<em>float</em><em> (</em><em>0-1</em><em>)</em><em>, </em><em>optional</em>) – Normalized amplitude dispersion threshold to select 1st order PSc.
The default is 0.25.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.prepare_insar_HDF</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.selectPSc</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.prepare_insar_HDF">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">prepare_insar_HDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parms</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.prepare_insar_HDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Create HDF data structure for InSAR processing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parms</strong> (<em>dict</em>) – <dl class="simple">
<dt>{</dt><dd><p>‘stackId’
‘stackDir’
‘subswath’
‘startDate’
‘min_lon’
‘max_lon’
‘min_lat’
‘max_lat’
‘aver_h’
‘D_A_thr’
‘oversample_factor’
‘plot_flag’
‘out_dir’</p>
</dd>
</dl>
</p></li>
<li><p><strong>}</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><dl class="simple">
<dt>stack</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>{attrs}</dt><dd><ul>
<li><p>masterDate</p></li>
<li><p>orbit</p></li>
<li><p>wavelength</p></li>
<li><p>centerLat</p></li>
<li><p>centerLon</p></li>
<li><p>centerH</p></li>
<li><p>azimuthSpacing</p></li>
<li><p>rangeSpacing</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>slcs</p></li>
<li><p>h2ph</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt>psc</dt><dd><blockquote>
<div><ul class="simple">
<li><p>{attrs}</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>azIdx</p></li>
<li><p>rgIdx</p></li>
<li><p>azimuth</p></li>
<li><p>range</p></li>
<li><p>xyz</p></li>
<li><p>plh</p></li>
<li><p>incAngle</p></li>
<li><p>satvec</p></li>
<li><p>SLC</p></li>
<li><p>IFG</p></li>
<li><p>D_A</p></li>
<li><p>(idx)</p></li>
<li><p>(h2ph)</p></li>
<li><p>(aps_phase)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>data &lt;HDF5 file&gt;</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.pseudoVCM">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">pseudoVCM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'dH':</span> <span class="pre">20,</span> <span class="pre">'seasonal':</span> <span class="pre">2,</span> <span class="pre">'vel':</span> <span class="pre">5}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.pseudoVCM" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pseudo variance-covariance matrix (VCM) for a given model and
soft estimation bounds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>) – Model type: ‘linear’/’seasonal’/’exponential’.</p></li>
<li><p><strong>bounds</strong> (<em>dict</em><em>, </em><em>optional</em>) – <dl>
<dt>bounds = {‘dH’<span class="classifier"># in [m]</span></dt><dd><blockquote>
<div><p>’vel’: # in [mm/year]
‘seasonal’: # in [mm]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>The default is:
bounds = {‘dH’ : 20, ‘vel’: 5, ‘seasonal’: 2}</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Q_b0</strong> – Pseudo VCM for M unknown parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(M,M) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.ref_coords2idx">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">ref_coords2idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psc0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refAz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refR</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.ref_coords2idx" title="Permalink to this definition">¶</a></dt>
<dd><p>Get ref.point index for a given azimuth and range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psc0</strong> (<em>&lt;HDF5&gt; file</em>) – Containing psc data.</p></li>
<li><p><strong>refAz</strong> (<em>int</em>) – Azimuth coordinate.</p></li>
<li><p><strong>refR</strong> (<em>int</em>) – Range coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Reference point index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.removeArc">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">removeArc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arcIdx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.removeArc" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove outlier arc</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.removePSC">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">removePSC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">badPsc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.removePSC" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove PSc from arcs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Containing PSc indices.</p></li>
<li><p><strong>arcs</strong> (<em>(</em><em>M</em><em>,</em><em>2</em><em>) </em><em>ndarray</em>) – Containing arc connections.</p></li>
<li><p><strong>badPsc</strong> (<em>(</em><em>K</em><em>,</em><em>)</em>) – Containing indices of K-PSc to be removed..</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>goodIdx</strong> (<em>(N-K,) ndarray</em>) – Containing only good PSc indices (former).</p></li>
<li><p><strong>ps_idx</strong> (<em>(N-K,) ndarray</em>) – Containing new indices 1:N-K</p></li>
<li><p><strong>arcs</strong> (<em>(L,)</em>) – Containing arc connections without arcs connecting bad PSc.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.remove_RPN">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">remove_RPN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotFlag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outDir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.remove_RPN" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove reference phase noise (RPN)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>&lt;hdf5 dataset&gt;</em>) – Containing network parameters after isnarUtils.solve_network()</p></li>
<li><p><strong>plotFlag</strong> (<em>boolean</em><em>, </em><em>optional</em>) – The default is 0.</p></li>
<li><p><strong>outDir</strong> (<em>str</em><em>, </em><em>optional</em>) – Full path to plot output directory.
The default is ‘’.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>RPN is computed as the per-epoch average phase residuals time series
over all PSc.</p>
<p class="rubric">References</p>
<p>See (Chang, 2018).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.remove_outliers">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">remove_outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdThr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.remove_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove outlier arcs from PSc network solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>&lt;HDF5&gt; file</em>) – Containing ‘psc’ and ‘network’ datasets.</p></li>
<li><p><strong>stdThr</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold on arc’s standard deviation in [mm]
The default value is None, hence automatic threshold value
is estimated from Chi-distribution of residuals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Function directly modifies the HDF5 datasets.
Creates outlier-less copies of original datasets in
‘/psc2’ and ‘/network2’.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.resetNetwork">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">resetNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.resetNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove PSI processing from HDF5 dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>&lt;HDF5 file&gt;</em>) – Containing already analyzed PS network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.saveHDF">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">saveHDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outFile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.saveHDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for saving the distionaries to &lt;HDF&gt; file structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psc</strong> (<em>dict</em>) – Containing PSc data extracted by insarUtils.selectPSc.</p></li>
<li><p><strong>stack</strong> (<em>classes.stack</em>) – Instance of stack class containing all extracted metadata.</p></li>
<li><p><strong>outFile</strong> (<em>str</em>) – Full path to the output .hdf5 file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.selectPSc</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">h5py</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.selectPSc">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">selectPSc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stackHDF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D_A_thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotFlag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ovs_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.selectPSc" title="Permalink to this definition">¶</a></dt>
<dd><p>Select Persistent Scatterer candidates (PSc) on the coregistered SLC
time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<em>classes.stack</em>) – </p></li>
<li><p><strong>stackHDF</strong> (<em>string</em>) – full path to HDF5 file containing data stack,
see ‘insarUtils.snap2HDF’.</p></li>
<li><p><strong>D_A_thr</strong> (<em>float</em><em>, </em><em>optional</em>) – Normalised amplitude dispersion threshold for PSc selection.
The default value is 0.4. Should be within 0.20-0.45</p></li>
<li><p><strong>plotFlag</strong> (<em>boolean</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>ovs_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – Oversampling factor for precise sub-pixel positioning os PS peak
responses. Should be power of 2 (recommended 16 for Sentinel-1 data)
The default value is 1, which means no oversampling is performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psc</strong> – Containing all PSc data:
‘azIdx’: azimuth grid indices
‘rgIdx’: range grid indices
‘azimuth’: azimuth (sub-pixel) coordinates in master frame
‘range’: range (sub-pixel) coordinates in master frame
‘SLC’: (N,M) ndarray of N points and M SLC time series
‘IFG’: (N,M) ndarray of N points and M interferometric phase
time series
‘D_A’: (N,) ndarray of normalised amplitude dispersions of N points</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.setRefPoint">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">setRefPoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotFlag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.setRefPoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Choose reference point for first-order PSc network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psc</strong> (<em>&lt;HDF5 dataset&gt;</em>) – Containing PSc data.</p></li>
<li><p><strong>network</strong> (<em>&lt;HDF5 dataset&gt;</em>) – Containing network data.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘auto’ - choosen automatically in barycentre and under
good coherence condition
‘constraint’ - chosen by given coordinates
(e.g. of corner reflector)
‘free’ - datum-free network solution
(equivalent to taking the overall average as reference)
The default is ‘auto’.</p></li>
<li><p><strong>plotFlag</strong> (<em>boolean</em><em>, </em><em>optional</em>) – The default is 1.</p></li>
<li><p><strong>**kwargs</strong><strong>[</strong><strong>'refLat'</strong><strong>]</strong> (<em>float</em><em>, </em><em>optional</em>) – </p></li>
<li><p><strong>**kwargs</strong><strong>[</strong><strong>'refLon'</strong><strong>]</strong> (<em>float</em><em>, </em><em>optional</em>) – Reference point latitude/longitude.
Use only for ‘constraint’ method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>refIdx</strong> – Reference PSc index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.snap2HDF">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">snap2HDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outHDF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.snap2HDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface function to extract SNAP processed stacks into HDF5 data
structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parms</strong> (<em>dict</em>) – containing processing parameters, see “insar.parms” template file</p></li>
<li><p><strong>outHDF</strong> (<em>string</em>) – Full path to output HDF file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>stack</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>classes.stack</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For full HDF5 file specification, see XXX.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.saveHDF</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.prepare_insar_HDF</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.solve_network">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">solve_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'seasonal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.solve_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate parameters of an integrated PS network.
The parameters are master atmosphere, residual heights and displacement
model parameters.
This version uses scene-averaged height-to-phase conversion factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>&lt;HDF5 dataset&gt;</em>) – Containing integrated network after insarUtils.spatialAmbiguity()</p></li>
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>optional</em>) – Displacement model: ‘linear’/’seasonal’/’exponential’.
The default is ‘seasonal’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">To</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">see</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.solve_network_precise">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">solve_network_precise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'seasonal'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.solve_network_precise" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate parameters of an integrated PS network.
The parameters are master atmosphere, residual heights and displacement
model parameters.
This version uses precise PS-wise height-to-phase conversion factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>&lt;HDF5 dataset&gt;</em>) – Containing integrated network after insarUtils.spatialAmbiguity()</p></li>
<li><p><strong>psc</strong> (<em>&lt;HDF5 dataset&gt;</em>) – Containing PSc data.</p></li>
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>optional</em>) – Displacement model: ‘linear’/’seasonal’/’exponential’.
The default is ‘seasonal’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>insarUtils.getPreciseH2PH() has to be run beforehand.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">To</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">see</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.spatialAmbiguity">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">spatialAmbiguity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.spatialAmbiguity" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatially integrate arc ambiguities in a PS network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>network</strong> (<em>&lt;HDF5 dataset&gt;</em>) – Containing network data after insarUtils.temporalAmbiguity() step</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Reference datum is defined using insarUtils.setRefPoint(), which should
be run beforhand.
insarUtils.network_cond() should be run beforehand to check on possible
singularity of the inversion system.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.temporalAmbiguity">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">temporalAmbiguity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'seasonal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'dH':</span> <span class="pre">20,</span> <span class="pre">'seasonal':</span> <span class="pre">2,</span> <span class="pre">'vel':</span> <span class="pre">5}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotFlag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.temporalAmbiguity" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve temporal ambiguities in a network of short arcs between PSc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stack</strong> (<em>&lt;HDF5&gt; file</em>) – Containing stack metadata.</p></li>
<li><p><strong>psc</strong> (<em>&lt;HDF5&gt; file</em>) – Containing PSc data.</p></li>
<li><p><strong>network</strong> (<em>&lt;HDF5&gt; file</em>) – Containing network data.</p></li>
<li><p><strong>model</strong> (<em>str</em>) – Model type: ‘linear’/’seasonal’/’exponential’.</p></li>
<li><p><strong>bounds</strong> (<em>dict</em><em>, </em><em>optional</em>) – <dl>
<dt>bounds = {‘dH’<span class="classifier"># in [m]</span></dt><dd><blockquote>
<div><p>’vel’: # in [mm/year]
‘seasonal’: # in [mm]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>The default is:
bounds = {‘dH’ : 20, ‘vel’: 5, ‘seasonal’: 2}</p>
</p></li>
<li><p><strong>plotFlag</strong> (<em>boolean</em><em>, </em><em>optional</em>) – The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Temporal ambiguities are solved using integer least-squares estimator
with LAMBDA bootstrapping method.
Also estimates variance components.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.updateHDF">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">updateHDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arc_idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.updateHDF" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove points/arcs in a HDF5 dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>&lt;HDF5 file&gt;</em>) – Containing ‘psc’ and ‘network’ datasets.</p></li>
<li><p><strong>ps</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – 1:N indices of outlier-free PSc.</p></li>
<li><p><strong>ps_idx</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Former indices of outlier-free PSc.</p></li>
<li><p><strong>arcs</strong> (<em>(</em><em>M</em><em>,</em><em>2</em><em>)</em>) – Outlier-free arcs.</p></li>
<li><p><strong>arc_idx</strong> (<em>(</em><em>M</em><em>,</em><em>2</em><em>)</em>) – FOrmer indices of outlier-free arcs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.remove_outliers</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Function directly modifies ‘/psc’ and ‘/network’ HDF5 datasets
and creates outlier-free versions in ‘/psc2’ and ‘network2’.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gecoris.insarUtils.updateHDF2">
<span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">updateHDF2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">badPsc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.updateHDF2" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove points in a HDF5 dataset.
Point-wise variant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>&lt;HDF5 file&gt;</em>) – Containing ‘psc’ and ‘network’ datasets.</p></li>
<li><p><strong>badPsc</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Indices of PSc to be removed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.remove_outliers</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">insarUtils.updateHDF</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Function directly modifies ‘/psc2’ and ‘/network2’ HDF5 datasets
already created by ‘insarUtils.updateHDF’ function.</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gecoris.insarUtils.variogram">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">gecoris.insarUtils.</span></span><span class="sig-name descname"><span class="pre">variogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.variogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Variogram model</p>
<p>…</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="gecoris.insarUtils.variogram.lags">
<span class="sig-name descname"><span class="pre">lags</span></span><a class="headerlink" href="#gecoris.insarUtils.variogram.lags" title="Permalink to this definition">¶</a></dt>
<dd><p>1D array containing empirical variogram lags with <cite>float</cite> type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gecoris.insarUtils.variogram.semivariance">
<span class="sig-name descname"><span class="pre">semivariance</span></span><a class="headerlink" href="#gecoris.insarUtils.variogram.semivariance" title="Permalink to this definition">¶</a></dt>
<dd><p>1D array containing semivariances corresponding to lags with
<cite>float</cite> type.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gecoris.insarUtils.variogram.emp_model">
<span class="sig-name descname"><span class="pre">emp_model</span></span><a class="headerlink" href="#gecoris.insarUtils.variogram.emp_model" title="Permalink to this definition">¶</a></dt>
<dd><p>containing Gaussian model fit to empirical variogram</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>(3,) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gecoris.insarUtils.variogram.fit_variogram">
<span class="sig-name descname"><span class="pre">fit_variogram</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.variogram.fit_variogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Least-squares fit of empirical variogram</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gecoris.insarUtils.variogram.gaussian_variogram_model">
<span class="sig-name descname"><span class="pre">gaussian_variogram_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.variogram.gaussian_variogram_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian variogram model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>(</em><em>3</em><em>,</em><em>) </em><em>array_like</em>) – List containing model parameters:
[psill, range, nugget]</p></li>
<li><p><strong>d</strong> (<em>(</em><em>N</em><em>,</em><em>) </em><em>ndarray</em>) – Distances to evaluate the model (in metres)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluated variogram model at N requested distances.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N,) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gecoris.insarUtils.variogram.plot_fit">
<span class="sig-name descname"><span class="pre">plot_fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.variogram.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot variogram fit</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gecoris.insarUtils.variogram.raw_variogram">
<span class="sig-name descname"><span class="pre">raw_variogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gecoris.insarUtils.variogram.raw_variogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a raw variogram of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>(</em><em>M</em><em>,</em><em>N</em><em>) </em><em>ndarray</em>) – N dimensional coordinates of M points [in metres]</p></li>
<li><p><strong>y</strong> (<em>(</em><em>M</em><em>,</em><em>) </em><em>ndarray</em>) – Observd values at M points</p></li>
<li><p><strong>nlags</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of variogram lags. The default is 0.25.</p></li>
<li><p><strong>max_d</strong> (<em>float</em><em>, </em><em>optional</em>) – Max distance threshold to evaluate semivariances.
The default is 10 km.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>input</strong> – y = data at points
nlags = number of bins
max_d = maximum distance to compute variogram</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>X = m x n np.array of m points in n dimensional coords</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="geoUtils.html" class="btn btn-neutral float-right" title="gecoris.geoUtils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modules.html" class="btn btn-neutral float-left" title="Modules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Richard Czikhardt

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>